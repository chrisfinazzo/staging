# Content Security Policy Configuration for Reverse Job Posting Microsite

# This CSP is designed to achieve a perfect score on Mozilla Observatory test suite

# Suitable for a static Eleventy-generated website

[security.headers]

# Content Security Policy - Restrictive policy for static site with Font Awesome support

content_security_policy = “””
default-src ‘none’;
script-src ‘self’ ‘unsafe-inline’ https://kit.fontawesome.com https://ka-f.fontawesome.com;
style-src ‘self’ ‘unsafe-inline’ https://use.fontawesome.com https://pro.fontawesome.com https://kit.fontawesome.com https://ka-f.fontawesome.com;
img-src ‘self’ data: https:;
font-src ‘self’ https://kit.fontawesome.com https://ka-f.fontawesome.com data:;
connect-src ‘self’ https://ka-f.fontawesome.com;
media-src ‘none’;
object-src ‘none’;
child-src ‘none’;
frame-src ‘none’;
worker-src ‘none’;
frame-ancestors ‘none’;
form-action ‘self’;
upgrade-insecure-requests;
block-all-mixed-content;
base-uri ‘self’;
manifest-src ‘self’
“””

# HTTP Strict Transport Security - Force HTTPS for 2 years

strict_transport_security = “max-age=63072000; includeSubDomains; preload”

# X-Frame-Options - Prevent clickjacking

x_frame_options = “DENY”

# X-Content-Type-Options - Prevent MIME type sniffing

x_content_type_options = “nosniff”

# Referrer Policy - Control referrer information

referrer_policy = “strict-origin-when-cross-origin”

# Permissions Policy - Restrict browser features

permissions_policy = “””
accelerometer=(),
ambient-light-sensor=(),
autoplay=(),
battery=(),
camera=(),
cross-origin-isolated=(),
display-capture=(),
document-domain=(),
encrypted-media=(),
execution-while-not-rendered=(),
execution-while-out-of-viewport=(),
fullscreen=(),
geolocation=(),
gyroscope=(),
keyboard-map=(),
magnetometer=(),
microphone=(),
midi=(),
navigation-override=(),
payment=(),
picture-in-picture=(),
publickey-credentials-get=(),
screen-wake-lock=(),
sync-xhr=(),
usb=(),
web-share=(),
xr-spatial-tracking=()
“””

# Cross-Origin-Embedder-Policy - Prevent loading of cross-origin resources

cross_origin_embedder_policy = “require-corp”

# Cross-Origin-Opener-Policy - Isolate browsing context

cross_origin_opener_policy = “same-origin”

# Cross-Origin-Resource-Policy - Control cross-origin access to resources

cross_origin_resource_policy = “same-origin”

# Alternative CSP for development environment (less restrictive)

[security.headers.development]
content_security_policy_dev = “””
default-src ‘self’;
script-src ‘self’ ‘unsafe-inline’ ‘unsafe-eval’ localhost:* ws: wss:;
style-src ‘self’ ‘unsafe-inline’;
img-src ‘self’ data: https: http: localhost:*;
font-src ‘self’ data:;
connect-src ‘self’ localhost:* ws: wss:;
media-src ‘self’;
object-src ‘none’;
child-src ‘none’;
frame-src ‘none’;
worker-src ‘self’;
frame-ancestors ‘none’;
form-action ‘self’;
base-uri ‘self’;
manifest-src ‘self’
“””

# Configuration notes and explanations

[security.notes]
description = “””
This Content Security Policy is designed for a static Eleventy microsite and
aims to achieve a perfect score on the Mozilla Observatory test suite.

Key features:

- Very restrictive default-src ‘none’ policy
- Allows self-hosted resources only
- Blocks all plugins, frames, and workers
- Enforces HTTPS with HSTS
- Prevents clickjacking with frame-ancestors ‘none’
- Includes all modern security headers
- Disables unnecessary browser permissions

For development, use the less restrictive CSP variant that allows localhost connections.
“””

implementation_guide = “””
Implementation options:

1. Netlify (_headers file):
   /*
   Content-Security-Policy: [CSP string here]
   Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
   X-Frame-Options: DENY
   X-Content-Type-Options: nosniff
   Referrer-Policy: strict-origin-when-cross-origin
1. Apache (.htaccess):
   Header always set Content-Security-Policy “[CSP string here]”
   Header always set Strict-Transport-Security “max-age=63072000; includeSubDomains; preload”
1. Nginx:
   add_header Content-Security-Policy “[CSP string here]” always;
   add_header Strict-Transport-Security “max-age=63072000; includeSubDomains; preload” always;
1. Meta tags (less secure, not recommended):

<meta http-equiv="Content-Security-Policy" content="[CSP string here]">
"""

adjustments_needed = “””
You may need to adjust this CSP if your site includes additional external resources:

- External images (add domains to img-src)
- Analytics scripts (add domains to script-src and connect-src)
- External stylesheets (add domains to style-src)
- Embedded content (modify frame-src, child-src)

Font Awesome is already configured with these domains:

- https://use.fontawesome.com (free CDN)
- https://pro.fontawesome.com (pro CDN)
- https://kit.fontawesome.com (kits and custom builds)
- https://ka-f.fontawesome.com (analytics and telemetry)

For Google Analytics, you would add:
script-src ‘self’ ‘unsafe-inline’ https://www.googletagmanager.com [existing FA domains];
connect-src ‘self’ https://www.google-analytics.com https://ka-f.fontawesome.com;
img-src ‘self’ data: https: https://www.google-analytics.com;

Note: Font Awesome kits may require ‘unsafe-inline’ for scripts, which is already included.
For the most secure setup, consider self-hosting Font Awesome instead of using CDN.
“””
